<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>PorÃ³wnywarka cen gier</title>
  <!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4631809342660457"
     crossorigin="anonymous"></script> -->
</head>
<link rel="stylesheet" href="style.css">
<body>
    <section id="banery">
    <header id="baner1">
        <p>Compare-Games</p>
        
    </header>
    <header id="baner2">
        <select id="lang" onchange="changeLanguage(), searchGame()">
        <option value="pl">Polski</option>
        <option value="en">English</option>
        
        </select>
        <a href="regulamin.html">Regulamin</a>
    </header>
</section>
    <section id="srodek">
            <nav>
                <h1>PorÃ³wnywaj ceny gier ðŸŽ®</h1>
                
                <input type="text" id="search" placeholder="Wpisz nazwÄ™ gry">
                

                <button onclick="searchGame()">Szukaj</button>    
                

                <label class="switch" for="showFree" style="display: inline-flex; align-items: center; gap: 48px; cursor: pointer;">
                    <input type="checkbox" id="showFree">
                    <span class="slider"></span> <p id="freeGamesLabel">PokaÅ¼ darmowe gry</p> 
                </label>
                

                
            </nav>
            <div id="sortowanie">
                <p>Sortuj wedÅ‚ug:</p>
              <select id="sort" onchange="searchGame()">
                 <option value="default">DomyÅ›lnie</option>
                  <option value="priceAsc">Cena rosnÄ…co</option>
                  <option value="priceDesc">Cena malejÄ…co</option>
                  <option value="alpha">Alfabetycznie</option>
                </select>
            </div>
        <div id="results">
          
              </div>
    </section>

    <footer>

        <p><a href="privacy.html" id="privacyLink">Polityka prywatnoÅ›ci</a> | <a href="contact.html" id="contactLink">Kontakt</a> | <a href="about.html" id="aboutLink">O nas</a> | <a href="faq.html" id="faqLink">FAQ</a></p>
    </footer>
    <!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4631809342660457"
     crossorigin="anonymous"></script> -->


  <script>
   const translations = {
  pl: {
    title: "PorÃ³wnywaj ceny gier ðŸŽ®",
    placeholder: "Wpisz nazwÄ™ gry",
    search: "Szukaj",
    offer: "SprawdÅº ofertÄ™",
    price: "NajtaÅ„sza cena",
    statute: "Regulamin",
    contact: "Kontakt",
    about: "O nas",
    freeGames: "PokaÅ¼ darmowe gry"
  },
  en: {
    title: "Compare games prices ðŸŽ®",
    placeholder: "Enter game name",
    search: "Search",
    offer: "Check offer",
    price: "Lowest price",
    statute: "Statute",
    contact: "Contact",
    about: "About us",
    freeGames: "Show free games"
  }
};
window.currentLang = "pl";

function changeLanguage() {
  const lang = document.getElementById("lang").value;

  document.querySelector("nav h1").innerText = translations[lang].title;
  document.getElementById("search").placeholder = translations[lang].placeholder;
  document.querySelector("button").innerText = translations[lang].search;
  document.getElementById("regulaminLink").innerText = translations[lang].statute;
  document.getElementById("contactLink").innerText = translations[lang].contact;
  document.getElementById("aboutLink").innerText = translations[lang].about;
  document.getElementById("freeGamesLabel").innerText = translations[lang].freeGames;
  // dodatkowe tÅ‚umaczenia przy renderowaniu wynikÃ³w
  window.currentLang = lang;
  
}

    





async function searchGame() {
    const game = document.getElementById("search").value;
    const sortOption = document.getElementById("sort").value;
    let showFree = document.getElementById("showFree").checked;
    const sortOption2 = document.getElementById("sortowanie");

    sortOption2.style.display = "flex"; // pokaÅ¼ dropdown sortowania po pierwszym wyszukaniu
    // ðŸ”¹ pÅ‚atne gry (TwÃ³j backend na Render)
    const res = await fetch(`https://compare-price-ybbv.onrender.com/search?game=${game}`);
    let paidGames = await res.json();

    let allGames = [...paidGames];

    // ðŸ”¹ jeÅ›li zaznaczony toggle â†’ dorzucamy darmowe gry
    if (showFree) {
        const freeRes = await fetch(`https://compare-price-ybbv.onrender.com/freegames`);
        let freeGames = await freeRes.json();

        // filtrujemy po nazwie Å¼eby pasowaÅ‚y do wpisanego tekstu
        freeGames = freeGames.filter(item =>
            item.title.toLowerCase().includes(game.toLowerCase())
        );

        // mapujemy Å¼eby pasowaÅ‚o do formatu pÅ‚atnych gier
        freeGames = freeGames.map(item => ({
            title: item.title,
            thumbnail: item.thumbnail,
            price: 0,
            link: item.game_url
        }));

        allGames = [...paidGames, ...freeGames];
    }

    // ðŸ”¹ sortowanie
    if (sortOption === "priceAsc") {
        allGames.sort((a, b) => parseFloat(a.price) - parseFloat(b.price));
    } else if (sortOption === "priceDesc") {
        allGames.sort((a, b) => parseFloat(b.price) - parseFloat(a.price));
    } else if (sortOption === "alpha") {
        allGames.sort((a, b) => a.title.localeCompare(b.title));
    }

    // ðŸ”¹ render wynikÃ³w
    let resultsDiv = document.getElementById("results");
    resultsDiv.innerHTML = "";

    if (allGames.length === 0) {
        resultsDiv.innerHTML = "<p>Brak wynikÃ³w.</p>";
        return;
    }

    allGames.forEach(item => {
        let div = document.createElement("div");
        div.className = "game-card";
        div.innerHTML = `
            <img src="${item.thumbnail}" alt="${item.title}" />
            <h3>${item.title}</h3>
            <p>${parseFloat(item.price) === 0 ? "Darmowa gra ðŸŽ‰" : "NajtaÅ„sza cena: " + item.price + " USD"}</p>
            <a href="${item.link}" target="_blank">SprawdÅº ofertÄ™</a>
        `;
        resultsDiv.appendChild(div);
    });
}



  </script>
</body>
</html>
